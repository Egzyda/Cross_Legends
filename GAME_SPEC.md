# Cross Legends（クロス・レジェンズ）完全仕様書

**最終更新: 2026-01-25**

---

## 📖 目次

1. [ゲーム概要](#ゲーム概要)
2. [ゲームシステム](#ゲームシステム)
3. [キャラクターシステム](#キャラクターシステム)
4. [戦闘システム](#戦闘システム)
5. [スキルシステム](#スキルシステム)
6. [成長システム](#成長システム)
7. [敵キャラクター設計](#敵キャラクター設計)
8. [ステータスバランス設計](#ステータスバランス設計)

---

## ゲーム概要

### 基本情報
- **タイトル**: Cross Legends（クロス・レジェンズ）
- **ジャンル**: ローグライトRPG
- **プラットフォーム**: モバイル（縦画面）
- **プレイ時間**: 1ラン 15-20分

### コンセプト
既存のアニメキャラクターを使用して3人パーティを編成し、ノードマップを進んでボスを倒すことを目指すターン制バトルゲーム。キャラクターは後から自由に追加可能。

---

## ゲームシステム

### 基本構造
- **2幕構成**: 第1幕 → 中ボス → 第2幕 → ラスボス
- **レベル制なし**: 固定ステータス + 戦闘後強化
- **サウンド**: なし
- **永続アップグレード**: なし
- **装備システム**: なし

### ノードマップ

#### 第1幕（10ノード）
- 戦闘：5
- エリート：2
- 休憩：1
- イベント：1
- 中ボス：1

#### 第2幕（10ノード）
- 戦闘：4
- エリート：2
- 休憩：1
- イベント：1
- 宝箱：1
- ラスボス：1

**総戦闘数**: 15戦（通常9 + エリート4 + ボス2）

### ノードの種類

#### 🗡️ 戦闘ノード
- 通常の敵と戦闘
- 勝利後、各キャラに報酬選択

#### ⚔️ エリートノード
- 強力な敵と戦闘
- HP +30%の強敵
- 報酬：ステータスUP倍率が+10%（通常+8% → +10%）

#### 🔥 休憩ノード
3つから1つ選択：
1. HP 40%回復
2. MP 40%回復
3. HP・MP 両方20%回復

#### ❓ イベントノード
- ランダムイベント（3択）
- 得するイベント、損するイベント、リスク/リターン型など
- 毎回結果がランダムで覚えゲーにならない

**イベント例**:
- 「商人との遭遇」：ゴールド払ってアイテム / 無視 / 脅す（運判定）
- 「神秘の祭壇」：HPを捧げてスキル獲得 / MP捧げてステータスUP / 去る
- 「野営地」：休憩して回復 / 訓練してステータスUP / 探索してアイテム
- 「宝箱発見」：全員HP+10% + ゴールド
- 「罠」：全員HP-15%
- 「怪しげな泉」：ランダムで大回復 or ダメージ

#### 💎 宝箱ノード
3つの報酬から1つ選択：
- HP回復アイテム（戦闘中使用、HP50%回復）
- MP回復アイテム（戦闘中使用、MP50%回復）
- 蘇生アイテム（戦闘不能から復活、HP30%）
- ステータスアップアイテム（誰か1人のステータス×1.1）

**アイテム所持数**: 各種最大3個

#### 👑 ボスノード
- 強力なボスと戦闘
- 勝利後、報酬選択

---

## キャラクターシステム

### キャラクター解放
- 最初から全キャラ使用可能
- プレイヤーが好きなキャラを自由に選んでパーティ編成
- **キャラ画像**:
  - 顔画像：正方形
  - 立ち絵：2:3の縦長画像

### ステータス

#### 基本ステータス（8種類）
- **HP**: 体力（0で戦闘不能）
- **MP**: スキル使用に必要
- **物理攻撃**: 通常攻撃・物理スキルのダメージ
- **魔法攻撃**: 魔法スキルのダメージ
- **物理防御**: 物理ダメージ軽減
- **魔法防御**: 魔法ダメージ軽減
- **速度**: 行動順決定（高い順）
- **運**: クリティカル率に影響、イベント成功率に影響

#### ステータスバランス調整式（NEW）

```
総価値 = (物理攻撃 × 1.0) + (魔法攻撃 × 1.0)
       + (物理防御 × 1.0) + (魔法防御 × 1.0)
       + (速度 × 1.0) + (HP × 0.5) + (MP × 0.7) + (運 × 0.19)

総価値目標: 600（誤差±20許容）
```

**運の重み変更理由**:
- クリティカル倍率が2倍→1.5倍に減少
- クリティカル率計算式が(運÷4)→(運÷3)に変更
- 運の戦闘への貢献度が約63%に減少したため、重みを0.3→0.19に調整

### クリティカルシステム（NEW）

```
クリティカル率 = 5% + (運 ÷ 3)%
クリティカルダメージ = 1.5倍
```

**例**:
- 運60 → クリ率25%、期待ダメージ1.125倍
- 運90 → クリ率35%、期待ダメージ1.175倍
- 運120 → クリ率45%（上限）、期待ダメージ1.225倍

### キャラタイプ
各キャラには以下のタイプタグを設定：
- 物理アタッカー
- 魔法アタッカー
- タンク
- ヒーラー
- サポート
- デバッファー

### 初期スキル
各キャラは固有の初期スキル1個を所持：
- キャラの個性・元作品に合わせたユニークスキル
- 汎用スキルより若干強い（例：威力220% vs 200%）
- 表示名はキャラに合わせてカスタマイズ可能

---

## 戦闘システム

### 戦闘画面レイアウト（縦画面）

```
┌─────────────┐
│   敵 敵 敵    │ ← 上：敵エリア
├─────────────┤
│ 味方 味方 味方 │ ← 中央：味方エリア
├─────────────┤
│ [攻撃][スキル] │ ← 下：コマンドエリア
│ [防御][アイテム]│
└─────────────┘
```

### ターン制バトルフロー

1. **戦闘開始時、3人全員の行動を選択**（ポケモン式）
   - 通常攻撃（対象選択）
   - スキル使用（対象選択、MP消費）
   - 防御（先制発動）
   - アイテム使用

2. **速度順に味方/敵混合で行動実行**
   - ※ 防御は速度無視で最優先発動

3. **全員行動後、次ターンへ**

4. **敵全滅で勝利、味方全滅で敗北**

### 配置と狙われやすさ

```
味方の配置：[左（前衛）] [中央] [右（後衛）]

狙われやすさ補正：
- 左：130%
- 中央：100%
- 右：70%

※ 挑発状態のキャラがいる場合、配置無視で100%狙われる
```

### ダメージ計算

```javascript
// 基本ダメージ
baseDamage = 攻撃力 × スキル威力倍率

// 防御力補正（防御力100につき被ダメージを約50%軽減）
damage = baseDamage / (1 + (防御力 / 100))

// 乱数（90%～110%）
damage *= 0.9 + Math.random() * 0.2

// クリティカル判定
クリティカル率 = 5 + (運 / 3) + スキルボーナス + クリティカルバフ
if (クリティカル発生) {
    damage *= 1.5
}

// 防御中
if (防御中) {
    damage *= 0.5
}
```

### 防御コマンド（NEW）

- 速度無視で先制発動
- そのターン受けるダメージ半減
- **MP10%回復**（新機能）

### MP回復システム（NEW）

- **ターン開始時**: 最大MPの10%自動回復
- **防御選択時**: さらに最大MPの10%回復（合計20%回復）
- **通常攻撃**: MP回復なし（仕様書から変更）
- **スキル使用**: MP回復なし

### 敵の出現数
- 最大3体同時出現
- 雑魚戦：1-3体
- エリート戦：1-2体
- ボス戦：1体

### ターゲット選択
- 基本：ランダム選択（配置補正あり）
- 挑発状態のキャラ優先

### 逃走
- 不可

### 状態異常・バフ/デバフ

#### ステータス操作系
- HP回復/ダメージ
- MP回復/消費
- 物理攻撃UP/DOWN
- 魔法攻撃UP/DOWN
- 物理防御UP/DOWN
- 魔法防御UP/DOWN
- 速度UP/DOWN
- **運UP/DOWN**（従来は「幸運付与」として実装）
- **クリティカル率UP**（`critBoost`、statusEffects配列で管理）

#### 状態異常系
- **毒**: ターン終了時ダメージ（最大HPの8%）
- **麻痺**: 確率で行動不能
- **沈黙**: スキル使用不可
- **スタン**: 1ターン行動不能
- **火傷**: ターン終了時ダメージ

#### 特殊効果
- **挑発**: 敵から狙われやすくなる（100%）
- **かばう**: 味方への攻撃を代わりに受ける
- **反撃**: 攻撃を受けた時に反撃
- **再生**: 毎ターンHP回復
- **防御**: ダメージ半減（1ターン）
- **ダメージ軽減**: 被ダメージ軽減
- **巨体化（Gmax）**: 全ステータス+100%（特殊）

#### バフ・デバフの重複仕様
- **重複許可方式**: 同じバフが複数回適用されても上書きではなく加算
- **例**: 幸運付与（運+50%）を2回受けた場合
  - 1回目: 基本運 × 1.5
  - 2回目追加後: 基本運 × 1.5 × 1.5 = 基本運 × 2.25（+125%）

---

## スキルシステム

### スキルスロット
- 各キャラ4つまでスキル装備可能
- 初期スキル1個 + 戦闘報酬で獲得3個

### スキル獲得方式
- タイプ別スキルプール
- スキル獲得時、そのキャラのタイプに合ったスキル候補3つを提示
- 70%：同タイプのスキル
- 30%：別タイプのスキル（ランダム要素）

→ 基本は役割に合ったスキルだが、「タンクヒーラー」「防御型アタッカー」なども可能

### スキル一覧

#### 物理アタッカー系
1. **強撃** - 単体物理攻撃（威力150%）MP: 30
2. **連続攻撃** - 単体物理攻撃2回（威力80%×2）MP: 40
3. **全力攻撃** - 単体物理攻撃（威力250%、次ターン防御-30%）MP: 60
4. **広範囲攻撃** - 全体物理攻撃（威力100%）MP: 50
5. **弱点攻撃** - 単体攻撃（威力120%、クリ率+30%）MP: 35

#### 魔法アタッカー系
1. **魔力弾** - 単体魔法攻撃（威力150%）MP: 30
2. **強魔力弾** - 単体魔法攻撃（威力200%）MP: 50
3. **魔力の嵐** - 全体魔法攻撃（威力110%）MP: 55
4. **魔力衝撃** - 単体魔法攻撃（威力140%、速度-20% 2ターン）MP: 45
5. **魔力爆発** - 単体魔法攻撃（威力130%、麻痺30%）MP: 40
6. **魔力充填** - 次ターン魔法攻撃+100%、MP: 15

#### タンク系
1. **挑発**（先制）- 2ターン挑発状態、自分の防御+20%、MP: 20
2. **鉄壁**（先制）- 2ターン自分の防御+50%、MP: 30
3. **かばう** - 2ターン味方1人への攻撃を代わりに受ける、MP: 25
4. **反撃の構え** - 防御+30%、攻撃受けた時に反撃（威力80%）2ターン、MP: 35
5. **不屈** - HP30%以下で発動可、HP50%回復+防御+40% 3ターン、MP: 60

#### ヒーラー系
1. **回復** - 単体HP 40%回復、MP: 35
2. **全体回復** - 全体HP 25%回復、MP: 60
3. **蘇生** - 戦闘不能の味方をHP30%で復活、MP: 80
4. **状態回復** - 単体の状態異常を全て解除、MP: 25
5. **再生付与** - 単体に3ターンHP10%回復効果、MP: 40

#### サポート系
1. **攻撃強化** - 単体の物攻/魔攻+30% 3ターン、MP: 30
2. **防御強化** - 単体の防御+40% 3ターン、MP: 30
3. **速度上昇** - 全体の速度+25% 2ターン、MP: 35
4. **幸運付与**（運+50% + クリ率+30% 3ターン）MP: 30
5. **MP回復** - 単体のMP 30%回復、MP: 20
6. **弱体化** - 敵単体の攻撃-30% 3ターン、MP: 30
7. **全体強化** - 全体の全ステータス+15% 2ターン、MP: 60

※ **幸運付与**は運バフとクリ率バフの両方を付与（従来仕様維持）

### MP消費の目安
- 小技：15-25 MP
- 中技：30-45 MP
- 大技：50-80 MP

---

## 成長システム

### 基本方針
- レベル制なし
- 各キャラは固定の初期ステータスでスタート
- 戦闘後の報酬で強化

### 戦闘後の報酬
戦闘勝利後、各キャラ（3人）それぞれに3つの選択肢を提示 → 計9回の選択

**選択肢**:
1. ステータスアップ（選択式）
2. スキル獲得/強化
3. （イベント・宝箱の場合はアイテムなども）

### ステータスアップ
- 8つのステータスから1つ選択
- **選んだステータス = 初期値 × (1 + 0.08 × 強化回数)**
- 加算方式（乗算ではない）

**例**: 物攻140のキャラ
```
1回目強化：140 → 151.2（140×1.08）
2回目強化：151.2 → 162.4（140×1.16）
3回目強化：162.4 → 173.6（140×1.24）
※ 毎回、元の値（140）の+8%ずつ増える
```

### エリート戦の特典
- ステータスUP倍率が+10%（通常+8% → +10%）
- **例**: 物攻140 → 154（140×1.10）

### 成長の目安
総戦闘15回のうち、1人あたり：
- ステータスUP：約7-8回
- スキル獲得：約7-8回

**最終的な成長幅**: 初期ステータスの1.6-1.8倍程度

---

## 敵キャラクター設計

### 基本方針
- 敵キャラはアニメ作品の敵キャラクターを使用
- 例：フリーザ、無惨、ディオ、エレン巨人体など

### 敵の構成

#### 雑魚・エリート敵
- 同じ敵キャラプールから選出
- エリートは同じキャラだが強化版
  - HP +30%
  - スキル +1個
- ランダムで1-3体出現

#### 中ボス
- 専用ボスキャラを数体用意
- ランダムで1体選出
- 毎回違うボスが登場

#### ラスボス
- 専用ラスボスキャラを複数用意
- ランダムで1体選出

### 敵の強さ基準（プレイヤー初期値を100%とする）

```
第1幕開始（1戦目）：60%
第1幕中盤（3戦目）：80%
第1幕エリート：100%（+30% HP）
中ボス：120%
第2幕開始：130%
第2幕中盤：150%
第2幕エリート：170%（+30% HP）
ラスボス：200%
```

### 敵の運とクリティカル率（NEW）

**運の上限**: 75（クリティカル率30%）

**理由**: 敵のクリティカル率が高すぎるとプレイヤーが即死するリスクがあるため、最大30%に制限

**ラスボスのバランス調整**: 期待攻撃力（最大攻撃×クリティカル期待倍率）が均等になるように運と攻撃力を調整

### 敵のスキルセット

#### 基本ルール
- 雑魚：通常攻撃 + スキル1個
- エリート：通常攻撃 + スキル2個
- ボス/ラスボス：通常攻撃 + スキル3-4個
- タイプに応じた汎用スキルを割り当て

### 敵AIの簡易ルール
1. MP不足なら通常攻撃
2. 複数体いる場合のみ、味方強化スキル使用
3. HP 50%以下なら回復/防御スキル優先
4. それ以外は攻撃スキルをランダム使用
5. 挑発など1体のとき意味がないスキルは使用しない

---

## ステータスバランス設計

### ステータス総価値計算式（NEW）

```
総価値 = (物理攻撃 × 1.0) + (魔法攻撃 × 1.0)
       + (物理防御 × 1.0) + (魔法防御 × 1.0)
       + (速度 × 1.0) + (HP × 0.5) + (MP × 0.7) + (運 × 0.19)
```

### 重み付けの根拠

| ステータス | 重み | 理由 |
|----------|------|------|
| 物理攻撃 | 1.0 | 直接ダメージに貢献 |
| 魔法攻撃 | 1.0 | 直接ダメージに貢献 |
| 物理防御 | 1.0 | 被ダメージ軽減 |
| 魔法防御 | 1.0 | 被ダメージ軽減 |
| 速度 | 1.0 | 先制攻撃の価値 |
| HP | 0.5 | 両防御に有効だが防御力ほど強くない |
| MP | 0.7 | スキル使用回数に影響 |
| **運** | **0.19** | クリティカル期待値への貢献度（NEW） |

### 運の重み変更履歴

**旧仕様（～2026-01-24）**:
```
運の重み: 0.3
クリ率: 5 + (運÷4)
クリ倍率: 2倍
```

**新仕様（2026-01-25～）**:
```
運の重み: 0.19
クリ率: 5 + (運÷3)
クリ倍率: 1.5倍
```

**変更理由**:
- クリティカル倍率が2倍→1.5倍に減少
- クリティカル率計算式が(運÷4)→(運÷3)に変更
- 運の戦闘への貢献度が**63.2%に減少**
- 運の重みを0.3 × 0.632 = **0.19**に調整して、総価値を維持

### キャラ設計の基準値

**目標総価値**: 600（誤差±20許容）

**範囲**: 580～620が理想

**特殊なケース**:
- タンク型：耐久特化で総価値が高くなる傾向
- アタッカー型：攻撃特化で総価値が低くなる傾向
- 個性を優先する場合は基準から外れることもあり

---

## データ構造

### プレイアブルキャラ

```javascript
{
  id: "character_001",
  name: "モンキー・D・ルフィ",
  displayName: "ルフィ",

  stats: {
    hp: 130,
    mp: 100,
    physicalAttack: 145,
    magicAttack: 35,
    physicalDefense: 60,
    magicDefense: 55,
    speed: 110,
    luck: 80
  },

  type: "physical_attacker",

  uniqueSkill: {
    id: "ultra_attack",
    displayName: "ゴムゴムの銃",
    basePower: 220,
    mpCost: 60,
    type: 'physical_attack',
    target: 'single_enemy',
    description: "単体に強力な物理攻撃（威力220%）"
  },

  image: {
    full: "img/luffy_full.png",
    face: "img/luffy_face.png"
  },

  skills: [],
  excludeSkills: ['ultra_attack']
}
```

### 敵キャラ

```javascript
{
  id: "enemy_001",
  name: "フリーザ",
  displayName: "フリーザ",
  type: "magic_attacker",

  baseStats: {
    hp: 850,
    mp: 250,
    physicalAttack: 100,
    magicAttack: 80,
    physicalDefense: 112,
    magicDefense: 120,
    speed: 110,
    luck: 75  // 上限75（クリ率30%）
  },

  skills: ['magic_storm'],

  uniqueSkill: {
    id: 'death_ball',
    displayName: 'デスボール',
    type: 'magic_attack',
    target: 'single_enemy',
    basePower: 160,
    mpCost: 60,
    description: '単体に超強力な魔法攻撃（威力180%）'
  },

  image: {
    full: "img/freeza.png"
  },

  rank: "last_boss"
}
```

---

## 今後のキャラ追加ガイドライン

### 新キャラ作成時のチェックリスト

1. **ステータス総価値を計算**
   ```
   総価値 = 物攻×1.0 + 魔攻×1.0 + 物防×1.0 + 魔防×1.0
          + 速度×1.0 + HP×0.5 + MP×0.7 + 運×0.19
   ```
   - 目標：580～620

2. **クリティカル率を確認**
   ```
   クリ率 = 5 + (運÷3)
   ```
   - 推奨：20～35%
   - 上限：45%（運120）

3. **キャラタイプに合ったステータス配分**
   - アタッカー：高攻撃、低耐久
   - タンク：高HP、高防御
   - ヒーラー：高MP、バランス型
   - サポート：高速度、高MP

4. **固有スキルの設定**
   - 汎用スキルより10～20%強い威力
   - キャラの個性を反映
   - MP消費は30～60が標準

5. **画像の準備**
   - 顔画像：正方形
   - 立ち絵：2:3の縦長

---

## 変更履歴

### 2026-01-25
- クリティカル倍率を2倍→1.5倍に変更
- クリティカル率計算式を(運÷4)→(運÷3)に変更
- 運の重みを0.3→0.19に変更
- 味方キャラ全員のMPを調整（運の重み変更を補償）
- 敵キャラの運を最大75に制限（クリ率30%上限）
- 防御コマンドにMP10%回復を追加
- MP回復システムを「ターン開始時10%」に変更

---

## FAQ

**Q: なぜクリティカル倍率を下げたのか？**
A: 2倍だと敵にクリティカルされた時の即死リスクが高く、運が高いキャラが強すぎたため。1.5倍にすることでバランスを改善。

**Q: 運の重みを0.19にした理由は？**
A: クリティカルシステムの変更により、運の戦闘への貢献度が約63%に減少したため、0.3 × 0.632 ≈ 0.19 に調整。

**Q: なぜ敵の運を75に制限？**
A: クリ率30%を超えると敵の攻撃が強すぎてゲームバランスが崩れるため。

**Q: 防御コマンドのMP回復は重複する？**
A: はい。ターン開始時の10%回復と防御コマンドの10%回復で合計20%回復します。

**Q: バフは重複する？**
A: はい。同じバフを複数回受けると加算（乗算）されます。例：運+50%を2回 → 1.5 × 1.5 = 2.25倍（+125%）

---

**このドキュメントは随時更新されます。新機能追加時は必ず更新してください。**
